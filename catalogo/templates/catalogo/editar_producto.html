{% extends 'core/base.html' %}
{% load static %}

{% block content %}

<h1 class="titulo">Editar Producto</h1>

<form action="" method="POST" enctype="multipart/form-data" class="formulario">
    {% csrf_token %}

    <!-- Nombre -->
    <label>Nombre del Producto:</label>
    <input type="text" name="nombre" value="{{ producto.nombre }}" required>

    <!-- Precio -->
    <label>Precio:</label>
    <input type="number" step="0.01" name="precio" value="{{ producto.precio }}" required>

    <!-- Descripción -->
    <label>Descripción:</label>
    <textarea name="descripcion">{{ producto.descripcion }}</textarea>

    <!-- Imagen -->
    <label>Foto del Producto (opcional):</label>
    {% if producto.imagen %}
        <img src="{{ producto.imagen.url }}" width="120" style="display:block; margin-bottom:10px;">
    {% endif %}
    <input type="file" name="imagen">

    <h3>Categorías:</h3>

    <!-- País -->
    <details open>
        <summary>País</summary>
        <select name="pais_origen">
            <option value="">-- Seleccionar --</option>
            {% for pais in paises %}
            <option value="{{ pais }}" {% if producto.pais_origen == pais %}selected{% endif %}>
                {{ pais }}
            </option>
            {% endfor %}
        </select>
    </details>

    <!-- Color -->
    <details>
        <summary>Color</summary>
        <select name="categoria">
            <option value="">-- Seleccionar --</option>
            {% for color in colores %}
            <option value="{{ color }}" {% if producto.categoria == color %}selected{% endif %}>
                {{ color }}
            </option>
            {% endfor %}
        </select>
    </details>

    <!-- Grado de alcohol -->
    <details>
        <summary>Grado de Alcohol</summary>
        <select name="grado_alcohol">
            <option value="">-- Seleccionar --</option>
            {% for ga in alcoholes %}
            <option value="{{ ga }}" 
                {% if producto.grado_alcohol|stringformat:"s" == ga %}
                    selected
                {% endif %}
            >
                {{ ga }}
            </option>
            {% endfor %}
        </select>
    </details>

    <!-- Tipo de uva -->
    <details>
        <summary>Tipo de Uva</summary>
        <select name="tipo_fruto">
            <option value="">-- Seleccionar --</option>
            {% for uva in uvas %}
            <option value="{{ uva }}" {% if producto.tipo_fruto == uva %}selected{% endif %}>
                {{ uva }}
            </option>
            {% endfor %}
        </select>
    </details>

    <!-- Volumen -->
    <details>
        <summary>Volumen</summary>
        <select name="subcategoria">
            <option value="">-- Seleccionar --</option>
            {% for vol in volumenes %}
            <option value="{{ vol }}" {% if producto.subcategoria == vol %}selected{% endif %}>
                {{ vol }}
            </option>
            {% endfor %}
        </select>
    </details>

    <button type="submit" class="btn-guardar">Guardar Cambios</button>
    <a href="{% url 'catalogo:inventario' %}" class="btn-cancelar">Cancelar</a>

</form>

<style>
    .formulario { 
        max-width: 600px; 
        margin: auto; 
        display: flex; 
        flex-direction: column; 
        gap: 15px; 
    }
    label { font-weight: bold; }
    input, textarea, select { 
        width: 100%; 
        padding: 8px; 
        border-radius: 5px; 
        border: 1px solid #ccc; 
    }
    summary { cursor: pointer; font-weight: bold; margin: 5px 0; }
    .btn-guardar, .btn-cancelar {
        padding: 10px 15px; 
        border-radius: 6px; 
        text-align: center; 
        font-weight: bold;
    }
    .btn-guardar { background: #8c2f39; color: white; }
    .btn-cancelar { background: #b9a89a; color: white; display: inline-block; }
</style>

{% endblock %}
